class MCB{constructor(e){this.config={cookieTypes:[],...e},Array.isArray(this.config.cookieTypes)||(console.warn("config.cookieTypes bukan array, menggunakan array kosong sebagai default"),this.config.cookieTypes=[]),this.wrapper=null,this.banner=null,this.modal=null,this.cookieIcon=null,this.backdrop=null,this.randomSuffix=null,this.modalEventListeners=null,this.bannerEventListeners=null,this.cookieIconEventListener=null,this.createWrapper(),this.shouldShowBackdrop()&&this.createBackdrop(),this.createCookieIcon(),this.createModal(),this.shouldShowBanner()?(this.createBanner(),this.showBackdrop()):this.showCookieIcon(),this.setupEventListeners(),this.hasSetInitialCookieChoices()&&(this.loadRequiredCookies(),this.runAcceptedCookieCallbacks())}handleCookieChoice(e){this.setInitialCookieChoiceMade(),this.removeBanner(),this.hideBackdrop(),this.toggleModal(!1),this.showCookieIcon();let t={};if(this.config.cookieTypes.forEach(n=>{let i=!!n.required||e;if(t[n.id]=i,localStorage.setItem(`mcc_${n.id}${this.getBannerSuffix()}`,i.toString()),i&&"function"==typeof n.onAccept)try{n.onAccept()}catch(o){console.warn(`Error menjalankan onAccept untuk ${n.id}:`,o)}else if(!i&&"function"==typeof n.onReject)try{n.onReject()}catch(s){console.warn(`Error menjalankan onReject untuk ${n.id}:`,s)}}),e&&"function"==typeof this.config.onAcceptAll?this.config.onAcceptAll():e||"function"!=typeof this.config.onRejectAll||this.config.onRejectAll(),"function"==typeof this.config.saveConsentChoices)try{this.config.saveConsentChoices(t)}catch(n){console.warn("Error menjalankan saveConsentChoices:",n)}if("function"==typeof this.config.applyConsentChoices)try{this.config.applyConsentChoices(t)}catch(i){console.warn("Error menjalankan applyConsentChoices:",i)}e&&"function"==typeof this.config.onConsentGiven?this.config.onConsentGiven():e||"function"!=typeof this.config.onConsentRejected||this.config.onConsentRejected(),this.updateCheckboxState(),console.debug("Pilihan cookie disimpan:",t)}createBanner(){this.banner=this.createWrapperChild(this.getBannerContent(),"mB"),this.banner&&this.config.position?.banner&&(["bottomLeft"].includes(this.config.position.banner)?this.banner.classList.add(this.config.position.banner):(console.warn(`Posisi banner tidak valid: ${this.config.position.banner}. Menggunakan default.`),this.banner.classList.add("bottomLeft"))),this.banner&&"function"==typeof this.config.onBannerOpen&&this.config.onBannerOpen()}createWrapper(){this.wrapper=document.createElement("div"),this.wrapper.id="mccW",document.body.insertBefore(this.wrapper,document.body.firstChild)}updateCheckboxState(e=!1){let t=this.modal.querySelector("#cookie-preferences"),n=t.querySelectorAll('input[type="checkbox"]'),i=new Map(this.config.cookieTypes.map(e=>[e.id,e]));n.forEach(t=>{let[,n]=t.id.split("cookies-")[1].split(`-${this.randomSuffix}`),o=i.get(n);if(!o){console.warn(`Cookie type ${n} tidak ditemukan`);return}if(e){let s=t.checked;if(o.required)localStorage.setItem(`mcc_${n}${this.getBannerSuffix()}`,"true");else if(localStorage.setItem(`mcc_${n}${this.getBannerSuffix()}`,s.toString()),s&&"function"==typeof o.onAccept)try{o.onAccept()}catch(c){console.warn(`Error menjalankan onAccept untuk ${n}:`,c)}else if(!s&&"function"==typeof o.onReject)try{o.onReject()}catch(a){console.warn(`Error menjalankan onReject untuk ${n}:`,a)}}else if(o.required)t.checked=!0,t.disabled=!0;else{let r=localStorage.getItem(`mcc_${n}${this.getBannerSuffix()}`);null!==r?t.checked="true"===r:t.checked=!!o.defaultValue}})}getModalContent(){let e=this.config.text?.preferences?.title||"Manage Consent Preferences",t=this.config.text?.preferences?.description||"<p>Kami menghormati hak privasi Anda. Anda dapat memilih untuk tidak mengizinkan beberapa jenis cookie. Preferensi cookie Anda akan berlaku di seluruh situs web kami.</p>",n=`<button class="modal-close" aria-label="Close Preferences Modal"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M19.4081 3.41559C20.189 2.6347 20.189 1.36655 19.4081 0.585663C18.6272 -0.195221 17.3591 -0.195221 16.5782 0.585663L10 7.17008L3.41559 0.59191C2.6347 -0.188974 1.36655 -0.188974 0.585663 0.59191C-0.195221 1.37279 -0.195221 2.64095 0.585663 3.42183L7.17008 10L0.59191 16.5844C-0.188974 17.3653 -0.188974 18.6335 0.59191 19.4143C1.37279 20.1952 2.64095 20.1952 3.42183 19.4143L10 12.8299L16.5844 19.4081C17.3653 20.189 18.6335 20.189 19.4143 19.4081C20.1952 18.6272 20.1952 17.3591 19.4143 16.5782L12.8299 10L19.4081 3.41559Z"/></svg></button>`,i=this.config.cookieTypes||[],o=this.getAcceptedCookies(),s=this.config.text?.banner?.acceptAllButtonText||"Terima",c=this.config.text?.banner?.acceptAllButtonAccessibleLabel,a=`<button class="accept-all st-button st-button--primary"${c&&c!==s?` aria-label="${c}"`:""}>${s}</button>`,r=this.config.text?.banner?.rejectNonEssentialButtonText||"Tolak",l=this.config.text?.banner?.rejectNonEssentialButtonLabel,h=`<button class="reject-all st-button st-button--secondary"${l&&l!==r?` aria-label="${l}"`:""}>${r}</button>`;this.randomSuffix=Math.random().toString(36).substr(2,6);let d=`<header><h1>${e}</h1>${n}</header>${t}<section id="cookie-preferences">${i.map(e=>{let t=o[e.id],n=!1;return t&&(n=!0),t||this.hasSetInitialCookieChoices()||(n=e.defaultValue),`<fieldset><legend>${e.name}</legend><div class="cookie-type-content"><div class="cookie-type-description">${e.description}</div><label class="switch" for="cookies-${e.id}-${this.randomSuffix}"><input type="checkbox" id="cookies-${e.id}-${this.randomSuffix}" ${e.required?"checked disabled":n?"checked":""} /><span class="switch__pill" aria-hidden="true"></span><span class="switch__dot" aria-hidden="true"></span><span class="switch__off" aria-hidden="true">Off</span><span class="switch__on" aria-hidden="true">On</span></label></div></fieldset>`}).join("")}</section><footer>${a}${h}<button class="save-preferences st-button st-button--secondary">Simpan preferensi</button></footer>`;return d}setupModalEventListeners(){let e=this.modal.querySelector(".modal-close"),t=this.modal.querySelector(".accept-all"),n=this.modal.querySelector(".reject-all"),i=this.modal.querySelector(".save-preferences");this.modalEventListeners=[];let o=(e,t,n)=>{e&&(e.addEventListener(t,n),this.modalEventListeners.push({element:e,event:t,handler:n}))};o(e,"click",()=>{this.toggleModal(!1);let e=this.hasSetInitialCookieChoices();e?this.runStoredCookiePreferenceCallbacks():this.handleClosedWithNoChoice()}),o(t,"click",()=>this.handleCookieChoice(!0)),o(n,"click",()=>this.handleCookieChoice(!1)),o(i,"click",()=>{let e={};if(this.config.cookieTypes.forEach(t=>{let n=document.getElementById(`cookies-${t.id}-${this.randomSuffix}`);if(!n){console.warn(`Checkbox untuk cookie ${t.id} tidak ditemukan`);return}e[t.id]=!!t.required||n.checked,localStorage.setItem(`mcc_${t.id}${this.getBannerSuffix()}`,e[t.id].toString())}),"function"==typeof this.config.saveConsentChoices)try{this.config.saveConsentChoices(e)}catch(t){console.warn("Error menjalankan saveConsentChoices:",t)}if("function"==typeof this.config.applyConsentChoices)try{this.config.applyConsentChoices(e)}catch(n){console.warn("Error menjalankan applyConsentChoices:",n)}this.toggleModal(!1),console.debug("Preferensi disimpan dari modal:",e)});let s=this.modal.querySelector("#cookie-preferences"),c=s.querySelectorAll('input[type="checkbox"]');c.forEach(e=>{let t=e=>{let[,t]=e.target.id.split("cookies-")[1].split(`-${this.randomSuffix}`),n=e.target.checked,i="true"===localStorage.getItem(`mcc_${t}${this.getBannerSuffix()}`);if(n!==i){let o=this.config.cookieTypes.find(e=>e.id===t);if(o){if(localStorage.setItem(`mcc_${t}${this.getBannerSuffix()}`,n.toString()),n&&"function"==typeof o.onAccept)try{o.onAccept()}catch(s){console.warn(`Error menjalankan onAccept untuk ${t}:`,s)}else if(!n&&"function"==typeof o.onReject)try{o.onReject()}catch(c){console.warn(`Error menjalankan onReject untuk ${t}:`,c)}}}};e.addEventListener("change",t),this.modalEventListeners.push({element:e,event:"change",handler:t})}),this.setupFocusTrap(this.modal,e)}destroyCookieBanner(){this.modalEventListeners&&(this.modalEventListeners.forEach(({element:e,event:t,handler:n})=>{e.removeEventListener(t,n)}),this.modalEventListeners=null),this.bannerEventListeners&&(this.bannerEventListeners.forEach(({element:e,event:t,handler:n})=>{e.removeEventListener(t,n)}),this.bannerEventListeners=null),this.cookieIconEventListener&&(this.cookieIcon.removeEventListener("click",this.cookieIconEventListener),this.cookieIconEventListener=null),this.wrapper&&this.wrapper.parentNode&&this.wrapper.parentNode.removeChild(this.wrapper),this.allowBodyScroll(),this.wrapper=null,this.banner=null,this.modal=null,this.cookieIcon=null,this.backdrop=null,this.randomSuffix=null}createWrapperChild(e,t){let n=document.createElement("div");return n.id=t,n.innerHTML=e,this.wrapper&&document.body.contains(this.wrapper)||this.createWrapper(),this.wrapper.appendChild(n),n}createBackdrop(){this.backdrop=this.createWrapperChild(null,"mBD")}showBackdrop(){this.backdrop&&(this.backdrop.style.display="block"),"function"==typeof this.config.onBackdropOpen&&this.config.onBackdropOpen()}hideBackdrop(){this.backdrop&&(this.backdrop.style.display="none"),"function"==typeof this.config.onBackdropClose&&this.config.onBackdropClose()}shouldShowBackdrop(){return this.config?.background?.showBackground||!1}setInitialCookieChoiceMade(){window.localStorage.setItem(`MCB_IC${this.getBannerSuffix()}`,1)}getAcceptedCookies(){return(this.config.cookieTypes||[]).reduce((e,t)=>(e[t.id]="true"===localStorage.getItem(`mcc_${t.id}${this.getBannerSuffix()}`),e),{})}runAcceptedCookieCallbacks(){if(!this.config.cookieTypes)return;let e=this.getAcceptedCookies();this.config.cookieTypes.forEach(t=>{if(!t.required&&e[t.id]&&"function"==typeof t.onAccept)try{t.onAccept()}catch(n){console.warn(`Error menjalankan onAccept untuk ${t.id}:`,n)}})}runRejectedCookieCallbacks(){if(!this.config.cookieTypes)return;let e=this.getRejectedCookies();this.config.cookieTypes.forEach(t=>{if(e[t.id]&&"function"==typeof t.onReject)try{t.onReject()}catch(n){console.warn(`Error menjalankan onReject untuk ${t.id}:`,n)}})}runStoredCookiePreferenceCallbacks(){this.config.cookieTypes.forEach(e=>{let t="true"===localStorage.getItem(`mcc_${e.id}${this.getBannerSuffix()}`);if(t&&"function"==typeof e.onAccept)try{e.onAccept()}catch(n){console.warn(`Error menjalankan onAccept untuk ${e.id}:`,n)}else if(!t&&"function"==typeof e.onReject)try{e.onReject()}catch(i){console.warn(`Error menjalankan onReject untuk ${e.id}:`,i)}})}loadRequiredCookies(){this.config.cookieTypes&&this.config.cookieTypes.forEach(e=>{if(e.required&&"function"==typeof e.onAccept)try{e.onAccept()}catch(t){console.warn(`Error menjalankan onAccept untuk ${e.id}:`,t)}})}getBannerContent(){let e=this.config.text?.banner?.title||"Privasi Anda penting bagi kami.",t=this.config.text?.banner?.description||'Kami memproses informasi pribadi Anda untuk mengukur dan meningkatkan situs dan layanan kami, untuk membantu kampanye pemasaran kami, dan untuk menyediakan konten dan iklan yang dipersonalisasi. Untuk informasi lebih lanjut, lihat <a href="/p/privacy-policy.html" target="_blank">Kebijakan Privasi</a> kami.',n=this.config.text?.banner?.acceptAllButtonText||"Terima",i=this.config.text?.banner?.acceptAllButtonAccessibleLabel,o=`<button class="accept-all st-button st-button--primary"${i&&i!==n?` aria-label="${i}"`:""}>${n}</button>`,s=this.config.text?.banner?.rejectNonEssentialButtonText||"Tolak",c=this.config.text?.banner?.rejectNonEssentialButtonAccessibleLabel,a=`<button class="reject-all st-button st-button--secondary"${c&&c!==s?` aria-label="${c}"`:""}>${s}</button>`,r=this.config.text?.banner?.preferencesButtonAccessibleLabel||"Kelola Preferensi",l=`<button class="preferences"${r?` aria-label="${r}"`:""}><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#000000" aria-hidden="true"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg></button>`,h=`<div class="actCT"><h2>${e}</h2>${t}</div><div class="actCC"><div class="actCC-setting">${l}</div>${o}${a}</div>`;return h}hasSetInitialCookieChoices(){return!!localStorage.getItem(`MCB_IC${this.getBannerSuffix()}`)}removeBanner(){this.banner&&this.banner.parentNode&&(this.banner.parentNode.removeChild(this.banner),this.banner=null,"function"==typeof this.config.onBannerClose&&this.config.onBannerClose())}shouldShowBanner(){return!1!==this.config.showBanner&&null===localStorage.getItem(`MCB_IC${this.getBannerSuffix()}`)}createModal(){this.modal=this.createWrapperChild(this.getModalContent(),"mM")}toggleModal(e){if(this.modal){if(this.modal.style.display=e?"flex":"none",e){this.showBackdrop(),this.hideCookieIcon(),this.removeBanner(),this.preventBodyScroll();let t=this.modal.querySelector(".modal-close");t.focus(),"function"==typeof this.config.onPreferencesOpen&&this.config.onPreferencesOpen(),this.updateCheckboxState(!1)}else this.setInitialCookieChoiceMade(),this.updateCheckboxState(!0),this.hideBackdrop(),this.showCookieIcon(),this.allowBodyScroll(),"function"==typeof this.config.onPreferencesClose&&this.config.onPreferencesClose()}}getCookieIconContent(){return`<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="none"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg>`}createCookieIcon(){this.cookieIcon=document.createElement("button"),this.cookieIcon.id="mCI",this.cookieIcon.innerHTML=this.getCookieIconContent(),this.config.text?.banner?.preferencesButtonAccessibleLabel&&(this.cookieIcon.ariaLabel=this.config.text?.banner?.preferencesButtonAccessibleLabel),this.wrapper&&document.body.contains(this.wrapper)||this.createWrapper(),this.wrapper.appendChild(this.cookieIcon),this.cookieIcon&&this.config.cookieIcon?.position&&this.cookieIcon.classList.add(this.config.cookieIcon.position),this.cookieIcon&&this.config.cookieIcon?.colorScheme&&this.cookieIcon.classList.add(this.config.cookieIcon.colorScheme)}showCookieIcon(){this.cookieIcon&&(this.cookieIcon.style.display="none")}hideCookieIcon(){this.cookieIcon&&(this.cookieIcon.style.display="none")}handleClosedWithNoChoice(){let e={};if(this.config.cookieTypes.forEach(t=>{let n=t.required||t.defaultValue;if(e[t.id]=n,localStorage.setItem(`mcc_${t.id}${this.getBannerSuffix()}`,n.toString()),n&&"function"==typeof t.onAccept)try{t.onAccept()}catch(i){console.warn(`Error menjalankan onAccept untuk ${t.id}:`,i)}else if(!n&&"function"==typeof t.onReject)try{t.onReject()}catch(o){console.warn(`Error menjalankan onReject untuk ${t.id}:`,o)}}),"function"==typeof this.config.saveConsentChoices)try{this.config.saveConsentChoices(e)}catch(t){console.warn("Error menjalankan saveConsentChoices:",t)}if("function"==typeof this.config.applyConsentChoices)try{this.config.applyConsentChoices(e)}catch(n){console.warn("Error menjalankan applyConsentChoices:",n)}this.setInitialCookieChoiceMade(),this.updateCheckboxState(),console.debug("Pilihan default disimpan saat modal ditutup:",e)}getFocusableElements(e){return e.querySelectorAll('button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])')}setupEventListeners(){this.banner&&this.setupBannerEventListeners(),this.modal&&this.setupModalEventListeners(),this.cookieIcon&&this.setupCookieIconEventListener()}setupBannerEventListeners(){let e=this.banner.querySelector(".accept-all"),t=this.banner.querySelector(".reject-all"),n=this.banner.querySelector(".preferences");this.bannerEventListeners=[];let i=(e,t,n)=>{e&&(e.addEventListener(t,n),this.bannerEventListeners.push({element:e,event:t,handler:n}))};i(e,"click",()=>{this.handleCookieChoice(!0),"function"==typeof this.config.onClickAccept&&this.config.onClickAccept()}),i(t,"click",()=>{this.handleCookieChoice(!1),"function"==typeof this.config.onClickReject&&this.config.onClickReject()}),i(n,"click",()=>{this.showBackdrop(),this.toggleModal(!0),"function"==typeof this.config.onClickPreferences&&this.config.onClickPreferences()});let o=this.getFocusableElements(this.banner),s=o[0],c=o[o.length-1],a=e=>{"Tab"===e.key&&(e.shiftKey&&document.activeElement===s?(c.focus(),e.preventDefault()):document.activeElement===c&&(s.focus(),e.preventDefault()))};this.banner.addEventListener("keydown",a),this.bannerEventListeners.push({element:this.banner,event:"keydown",handler:a}),"wizard"!==this.config.mode&&e?.focus()}setupCookieIconEventListener(){let e=()=>{this.modal?"none"===this.modal.style.display||""===this.modal.style.display?(this.toggleModal(!0),this.hideCookieIcon()):this.toggleModal(!1):(this.createModal(),this.toggleModal(!0),this.hideCookieIcon())};this.cookieIcon.addEventListener("click",e),this.cookieIconEventListener=e}setupFocusTrap(e,t){let n=this.getFocusableElements(e),i=n[0],o=n[n.length-1];e.addEventListener("keydown",t=>{"Tab"===t.key&&(t.shiftKey?document.activeElement===i&&(o.focus(),t.preventDefault()):document.activeElement===o&&(i.focus(),t.preventDefault())),"Escape"===t.key&&e===this.modal&&this.toggleModal(!1)}),t?.focus()}getBannerSuffix(){return this.config.bannerSuffix?"_"+this.config.bannerSuffix:""}preventBodyScroll(){document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"}allowBodyScroll(){document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}getRejectedCookies(){return(this.config.cookieTypes||[]).reduce((e,t)=>(e[t.id]="false"===localStorage.getItem(`mcc_${t.id}${this.getBannerSuffix()}`),e),{})}}!function(){window.MCBManager={};let e={},t;function n(){if(!t){if(!e.cookieTypes||!Array.isArray(e.cookieTypes)){console.warn("Inisialisasi banner cookie ditunda: config.cookieTypes tidak valid. Panggil updateCookieBannerConfig dengan konfigurasi yang valid.");return}if(t=new MCB(e),console.debug("Banner cookie diinisialisasi dengan konfigurasi:",e),"function"==typeof e.onConsentGiven){let n=t.getBannerSuffix(),i=new MutationObserver(()=>{let t=[`mcc_analytics${n}`,`mcc_marketing${n}`,`mcc_necessary${n}`,`mcc_functionality${n}`],o=t.some(e=>null!==localStorage.getItem(e));if(o){try{e.onConsentGiven()}catch(s){console.warn("Error menjalankan onConsentGiven:",s)}i.disconnect()}});i.observe(document,{subtree:!0,childList:!0})}}}window.MCBManager.initCookieBanner=n,window.MCBManager.updateCookieBannerConfig=function i(o={}){e={...e,...o},t&&("function"==typeof t.destroyCookieBanner&&t.destroyCookieBanner(),t=null),document.body?n():document.addEventListener("DOMContentLoaded",n,{once:!0})},window.MCBManager.injectScript=function e(t,n){let i=document.querySelector(`script[src="${t}"]`);if(i)return;let o=document.createElement("script");o.src=t,"async"===n?o.async=!0:"defer"===n&&(o.defer=!0),document.head.appendChild(o)},"loading"===document.readyState?document.addEventListener("DOMContentLoaded",n,{once:!0}):n()}();